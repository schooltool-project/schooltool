<html i18n:domain="schooltool">
<head>
  <title tal:content="view/title">Timetable</title>
  <style type="text/css">
    table { border-collapse: collapse; }
    td, th { border: 1px solid black; }
  </style>
</head>
<body>
  <h1 tal:content="view/title">Timetable</h1>
  <table border="1">
    <tr>
      <th tal:repeat="day context/day_ids" tal:content="day"
          colspan="2">Day N</th>
    </tr>
    <tr tal:repeat="row view/rows"><tal:block tal:repeat="col row">
      <th tal:content="col/period">1</th>
      <td tal:content="col/activity">Act1</td>
    </tal:block></tr>
  </table>
<tal:if condition="context/exceptions">
  <h2 i18n:translate="">Timetable exceptions</h2>
  <ul>
    <tal:block repeat="exc context/exceptions">
    <li tal:condition="not:exc/replacement" i18n:translate="">
      On <span tal:replace="python:exc.date.strftime('%Y-%m-%d')"
      i18n:name="date" />, period <span tal:replace="exc/period_id"
      i18n:name="period" />, <span tal:replace="exc/activity/title"
      i18n:name="activity" /> is canceled.
    </li>
    <li tal:define="ev exc/replacement"
        tal:condition="python: ev and ev.dtstart.date() == exc.date"
        i18n:translate="">
      On <span tal:replace="python:exc.date.strftime('%Y-%m-%d')"
      i18n:name="date" />, period <span tal:replace="exc/period_id"
      i18n:name="period" />, <span tal:replace="exc/activity/title"
      i18n:name="activity" /> is replaced with <span tal:replace="ev/title"
      i18n:name="title" />
      from <span tal:replace="python: ev.dtstart.strftime('%H:%M')"
      i18n:name="start" /> to <span tal:define="dtend python:ev.dtstart +
      ev.duration" tal:replace="python: dtend.strftime('%H:%M')"
      i18n:name="end" />.
    </li>
    <li tal:define="ev exc/replacement"
        tal:condition="python: ev and ev.dtstart.date() != exc.date"
        i18n:translate="">
      On <span tal:replace="python:exc.date.strftime('%Y-%m-%d')"
      i18n:name="date" />, period <span tal:replace="exc/period_id"
      i18n:name="period" />, <span tal:replace="exc/activity/title"
      i18n:name="activity" /> is replaced with <span tal:replace="ev/title"
      i18n:name="title" />
      from <span tal:replace="python: ev.dtstart.strftime('%H:%M')"
      i18n:name="start" /> to <span tal:define="dtend python:ev.dtstart +
      ev.duration" tal:replace="python: dtend.strftime('%H:%M')"
      i18n:name="end" /> on <span
      tal:replace="python:ev.dtstart.strftime('%Y-%m-%d')" i18n:name="new_date"
      />.
    </li>
    </tal:block>
  </ul>
</tal:if>
</body>
</html>
