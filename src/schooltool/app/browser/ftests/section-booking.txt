Tests for resource booking in timetable events
----------------------------------------------

A manager logs in:

    >>> from zope.testbrowser.testing import Browser
    >>> from schooltool.app.browser.ftests import setUpTimetabling
    >>> manager = Browser()
    >>> manager.addHeader('Authorization', 'Basic manager:schooltool')
    >>> manager.handleErrors = False

And sets up timetabling:

    >>> setUpTimetabling(manager, user='frog', password='pwd')

Let's create a resource:

    >>> manager.open("http://localhost/resources")
    >>> manager.getLink('New Resource').click()
    >>> manager.getControl('Title').value = "A Resource"
    >>> manager.getControl('Add').click()

and book it for our history class:

    >>> print rest("""
    ... POST /sections/history6a/relationships HTTP/1.1
    ... Authorization: Basic manager:schooltool
    ... Content-Type: text/xml
    ...
    ... <relationship xmlns="http://schooltool.org/ns/model/0.1"
    ...               xmlns:xlink="http://www.w3.org/1999/xlink"
    ...               xlink:type="simple"
    ...               xlink:role="http://schooltool.org/ns/sectionbooking/resource"
    ...               xlink:arcrole="http://schooltool.org/ns/sectionbooking"
    ...               xlink:href="http://localhost/resources/a-resource"/>
    ... """, handle_errors=False)
    HTTP/1.1 201 Created
    ...

Let's check that relationship was created:

    >>> print rest("""
    ... GET /sections/history6a/relationships HTTP/1.1
    ... Authorization: Basic manager:schooltool
    ... """)
    HTTP/1.1 200 Ok
    Content-Length: ...
    Content-Type: text/xml; charset=UTF-8
    Set-Cookie: ...
    <BLANKLINE>
    <relationships xmlns:xlink="http://www.w3.org/1999/xlink"
                   xmlns="http://schooltool.org/ns/model/0.1">
      <existing>
        <relationship xlink:type="simple"
                      xlink:role="http://schooltool.org/ns/coursesections/course"
                      xlink:arcrole="http://schooltool.org/ns/coursesections"
                      xlink:href="http://localhost/courses/history-6">
          <manage xlink:type="simple"
                  xlink:href="http://localhost/sections/history6a/relationships/1"/>
        </relationship>
        <relationship xlink:type="simple"
                      xlink:role="http://schooltool.org/ns/instruction/instructor"
                      xlink:arcrole="http://schooltool.org/ns/instruction"
                      xlink:href="http://localhost/persons/frog">
          <manage xlink:type="simple"
                  xlink:href="http://localhost/sections/history6a/relationships/2"/>
        </relationship>
        <relationship xlink:type="simple"
                      xlink:role="http://schooltool.org/ns/sectionbooking/resource"
                      xlink:arcrole="http://schooltool.org/ns/sectionbooking"
                      xlink:href="http://localhost/resources/a-resource">
          <manage xlink:type="simple"
                  xlink:href="http://localhost/sections/history6a/relationships/3"/>
        </relationship>
      </existing>
    </relationships>
    <BLANKLINE>
