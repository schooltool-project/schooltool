<metal:block define-macro="page" i18n:domain="schooltool">
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title metal:define-slot="title">[Title]</title>
  <link rel="stylesheet" href="/schooltool.css" />
  <metal:block metal:define-slot="extrahead" />
</head>
<body metal:define-slot="body">
  <div class="header">
    <div class="logo">
      <a href="/start">
        <img src="/logo.png" alt="SchoolTool" class="logo"
             i18n:attributes="alt" />
      </a>
    </div>
    <h1 metal:define-slot="h1" i18n:translate="">Welcome to SchoolTool</h1>
    <div class="login" tal:condition="not:request/authenticated_user"
         i18n:translate="">
      Not logged in.
    </div>
  </div>
  <div class="navigation">
    <div class="login" tal:condition="request/authenticated_user">
      <span class="userlabel" i18n:translate="">User:</span>
      <span class="username" tal:content="request/authenticated_user/title" />.

      <tal:if condition="view/isNotable">
        <a href="" i18n:translate=""
          tal:attributes="href string:/notes/add.html?toadd=${context/@@path}"
          >Add note</a>.
      </tal:if>

      <a href="/logout" i18n:translate=""
         tal:attributes="href string:/logout?url=${request/path}">Log out</a>.
    </div>
    <metal:block metal:define-slot="navigation">
      <span tal:define="crumbs view/listBreadcrumbs"
            tal:condition="crumbs" tal:repeat="crumb crumbs">
        <a tal:attributes="href crumb/url"
           tal:content="crumb/title" />
        <span tal:condition="not: repeat/crumb/end">&gt;</span>
      </span>
    </metal:block>
    &nbsp;
  </div>
  <div class="content">

    <p metal:define-slot="content">[Content]</p>

  </div>
  <metal:macro use-macro="view/macros/notes"/>
</body>
</html>
</metal:block>

<metal:block define-macro="calendarpage" i18n:domain="schooltool">
<html metal:use-macro="view/macros/page">
<title metal:define-slot="title" metal:fill-slot="title">[Title]</title>
<body>
  <h1 metal:define-slot="h1" metal:fill-slot="h1"
      i18n:translate="">Welcome to SchoolTool</h1>
  <div metal:fill-slot="content">
    <div class="calnav" tal:define="update view/update">
      <a class="calnav" tal:attributes="href python:view.calURL('daily')"
         i18n:translate="">Daily</a>
      <a class="calnav" tal:attributes="href python:view.calURL('weekly')"
         i18n:translate="">Weekly</a>
      <a class="calnav" tal:attributes="href python:view.calURL('monthly')"
         i18n:translate="">Monthly</a>
      <a class="calnav" tal:attributes="href python:view.calURL('yearly')"
         i18n:translate="">Yearly</a>
    </div>
    <div class="calcontent">
      <p metal:define-slot="content">[Content]</p>
    </div>
    <p>
      <a tal:attributes="href python:view.addParam('cal_periods', 'yes')"
         tal:condition="not: python:request.getCookie('cal_periods')"
         i18n:translate="" class="action">Show time in periods</a>
      <a tal:attributes="href python:view.addParam('cal_periods', 'no')"
         tal:condition="python:request.getCookie('cal_periods')"
         i18n:translate="" class="action">Periods off</a>
      <a class="action"  tal:condition="view/isManager"
         tal:attributes="href string:${context/@@absolute_url}/acl.html"
         i18n:translate="">Edit ACL</a>
    </p>
  </div>
</body>
</html>
</metal:block>

<metal:block define-macro="notes">
  <tal:block define="notes python:view.getNotations(request)">
    <tal:if condition="notes">
      <div class="notes">
        <h3>Notes</h3>
        <dl>
          <tal:loop repeat="note notes">
            <dt>
              <a href="" 
                tal:attributes="href note/@@absolute_url"
                tal:content="note/title"></a>
            </dt>
            <dd>
              <div tal:content="note/body"></div>
              <div class="byline"
                  tal:define="owner note/owner">
                  By: <span tal:content="owner/title"/>
              </div>
            </dd>
          </tal:loop>
        </dl>
      </div>
    </tal:if>
  </tal:block>
</metal:block>

<metal:block define-macro="render-infowidget">
    <!-- Render dynamicfacet fields:
    
    Parameters:
        field: a DynamicSchemaField
        isSchema: boolean, true if we are creating a schemata.
    -->
    <label tal:content="field/label"></label>
    <tal:if condition="python:field['ftype'] == 'textarea'">
        <textarea name="" value=""
            tal:attributes="name field/name"
            tal:content="field/value">
        </textarea>
    </tal:if>
    <tal:if condition="python:field['ftype'] == 'selection'">
        <select name="" tal:attributes="name field/name">
            <tal:loop repeat="option field/vocabulary">
                <option tal:content="option"></option>
            </tal:loop>
        </select>
        <textarea name=""
            tal:condition="isSchema|nothing"
            tal:attributes="name string:${field/name}_vocabulary"
            tal:content="python:'\n'.join(field.vocabulary)"></textarea>
    </tal:if>
    <tal:if condition="python:field['ftype'] == 'multiselection'">
        <select multiple="multiple" name="" tal:attributes="name field/name">
            <tal:loop repeat="option field/vocabulary">
                <option tal:content="option"></option>
            </tal:loop>
        </select>
        <textarea name=""
            tal:condition="isSchema|nothing"
            tal:attributes="name string:${field/name}_vocabulary"
            tal:content="python:'\n'.join(field.vocabulary)"></textarea>
    </tal:if>
    <tal:if condition="python:field['ftype'] == 'checkbox'">
        <input type="checkbox" name=""
          tal:attributes="name field/name"/>
    </tal:if>
    <tal:if condition="python:field['ftype'] == 'text'">
      <input type="text" name=""
        tal:attributes="name field/name;
                        value field/value"/>
    </tal:if>
</metal:block>
<metal:block define-macro="dynamic-facet">
    <!-- Requres a DynamicFacet defined as 'facet' prior to calling -->
    <div class="dynamic-facet">
        <h3 tal:content="facet/__name__"></h3>
        <div class="row" tal:repeat="field facet/fields">
            <label tal:content="field/label"></label>
            <span tal:content="field/value"></span>
        </div>
    </div>
</metal:block>
