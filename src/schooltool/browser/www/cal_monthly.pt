<html metal:use-macro="view/macros/calendarpage" i18n:domain="schooltool">
<head>
  <title metal:fill-slot="title" i18n:translate="">Calendar</title>
</head>
<body>
  <h1 metal:fill-slot="h1" i18n:translate="">
    Calendar for <span tal:replace="context/__parent__/title" i18n:name="title" />
  </h1>
  <metal:block metal:fill-slot="content">
    <h2 tal:content="view/title" />
    <div class="calnav">
      <a tal:attributes="href python:view.calURL('monthly', view.prevMonth())"
         i18n:translate="">Previous month</a>
      <a tal:attributes="href request/path"
         i18n:translate="">Current month</a>
      <a tal:attributes="href python:view.calURL('monthly', view.nextMonth())"
         i18n:translate="">Next month</a>
    </div>
    <table class="cal_monthly"
           tal:define="weeks view/getCurrentMonth">
    <tr>
      <th>&nbsp;</th>
      <th class="cal_monthly_weekday"
            tal:repeat="weekday python:weeks[0]"
            tal:content="python:view.dayOfWeek(weekday.date)" />
    </tr>
    <tr tal:repeat="week weeks">
      <td class="cal_monthly_weekno">
         <a class="cal_monthly_weekno"
            tal:content="python:view.weekTitle(week[0].date)"
            tal:attributes="href python:view.calURL('weekly', week[0].date)" />
      </td>
      <tal:block tal:repeat="day week">
      <td class="cal_monthly_day"
          tal:define="same_month python:day.date.month == view.cursor.month"
          tal:attributes="class python:same_month and 'cal_monthly_day'
                                                  or 'cal_monthly_day_other'">
        <a class="cal_weekly_dayno" tal:content="day/date/day"
           tal:attributes="href python:view.calURL('daily', day.date)" />
        <div tal:repeat="event day/events"
             tal:content="structure python:view.eventShort(event)"
             tal:attributes="class python:view.eventClass(event)"
             />
      </td>
      </tal:block>
    </tr>
    </table>
  </metal:block>
</body>
</html>
