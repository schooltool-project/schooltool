<html metal:use-macro="view/macros/page" i18n:domain="schooltool">
<head>
  <title metal:fill-slot="title" i18n:translate="">Calendar</title>
</head>
<body>
  <h1 metal:fill-slot="h1" i18n:translate="">
    Calendar for <span tal:replace="context/__parent__/title" />
  </h1>
  <metal:block metal:fill-slot="content">
    <div class="error" tal:content="view/update" />
    <div>
      <a tal:attributes="href
           string:${context/__parent__/@@absolute_url}/calendar_weekly.html"
         >Weekly calendar</a>
    </div>
    <a tal:attributes="href string:${request/path}?date=${view/prevMonth}"
       i18n:translate="">Previous month</a> |
    <a tal:attributes="href request/path"
       i18n:translate="">Current month</a> |
    <a tal:attributes="href string:${request/path}?date=${view/nextMonth}"
       i18n:translate="">Next month</a>

    <table class="cal_monthly"
           tal:define="weeks view/getMonth">
    <tr>
      <th>&nbsp;</th>
      <th class="cal_monthly_weekday"
            tal:repeat="weekday python:weeks[0]"
            tal:content="python:weekday.date.strftime('%A')" />
    </tr>
    <tr tal:repeat="week weeks">
      <!-- XXX not translatable -->
      <td class="cal_monthly_weekno">
         <a class="cal_monthly_weekno"
            tal:content="python:'Week ' + week[0].date.strftime('%V')"
            tal:attributes="href python:view.calURL('weekly', week[0].date)" />
      <td class="cal_monthly_day"
          tal:repeat="day week">
        <a class="cal_weekly_dayno" tal:content="day/date/day"
           tal:attributes="href python:view.calURL('daily', day.date)" />
        <div class="event_weekly"
             tal:repeat="event day/events"
             tal:content="python:event.title+event.dtstart.strftime(' (%H:%M)')"
             />
      </td>
    </tr>
    </table>
  </metal:block>
</body>
</html>
