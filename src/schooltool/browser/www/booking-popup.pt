<html metal:use-macro="view/macros/popup" i18n:domain="schooltool">
<head>
  <title metal:fill-slot="title" i18n:translate="">Book a resource</title>
</head>
<body>
  <h1 style="display:none" metal:fill-slot="h1" i18n:translate="">
    Book resource <span tal:replace="context/title" i18n:name="title" />
  </h1>

<metal:block metal:fill-slot="content">

  <div class="error" tal:condition="not:view/listPersons">
    <p i18n:translate="">
      Sorry, you don't have permissions to book this resource.
    </p>
    <p><a href="/busysearch" i18n:translate="">Back to resource search</a></p>
  </div>

  <tal:block condition="view/booked">
    <p i18n:translate="">Resource booked.</p>
    <p>
      <a href="javascript:opener.location.reload();window.close();" 
          i18n:translate="">
          Close Window
      </a>
    </p>
  </tal:block>

  <tal:block condition="python: not view.booked and view.listPersons()">

  <form class="standalone popup" method="POST" tal:attributes="action request/path">
  <h3 i18n:translate="">Book resource</h3>
  <fieldset>
    <legend i18n:translate="">Resource</legend>
    <div class="error" tal:condition="view/error" tal:content="view/error" />
    <div class="row" tal:replace="structure view/owner_widget" />
    <div class="row" tal:replace="structure view/date_widget" />
    <div class="row" tal:replace="structure view/time_widget" />
    <div class="row" tal:replace="structure view/duration_widget" />
    <div class="row">
      <input id="conflicts" name="conflicts" type="checkbox" value="ignore" />
      <label class="plain" for="conflicts" i18n:translate="">Ignore conflicts</label>
    </div>
  </fieldset>
    <div class="buttons">
      <input class="button" name="CONFIRM_BOOK" type="submit" value="Book"
             i18n:attributes="value"/>
    </div>
  </form>
  </tal:block>

</metal:block>
</body>
</html>
