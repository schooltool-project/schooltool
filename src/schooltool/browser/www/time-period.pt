<html metal:use-macro="view/macros/page" i18n:domain="schooltool">
<head>
  <title metal:fill-slot="title" tal:content="view/title">Time period</title>
  <script type="text/javascript" metal:fill-slot="extrahead">
    function update(idx) {
        var checkbox = document.getElementById('c' + idx);
        var cell = document.getElementById('td' + idx);
        if (checkbox.checked) {
            cell.className = "holiday";
        } else {
            cell.className = "schoolday";
        }
    }
    function toggle(idx) {
        var checkbox = document.getElementById('c' + idx);
        checkbox.checked = !checkbox.checked;
        update(idx);
    }
    document.write('\074style\076 input.chk { display: none } \074/style\076');
  </script>
</head>
<body>
  <h1 metal:fill-slot="h1" tal:content="view/title">Time period</h1>
<metal:block metal:fill-slot="content">

<form class="plain" method="POST" tal:attributes="action request/uri"
      tal:define="calendar view/calendar">

<div class="info" tal:condition="view/status" tal:content="view/status">
  [Status message]
</div>

<p i18n:translate="" tal:condition="not:view/context">
First, please name and define the time period itself.  The name should be short
and contain no spaces (e.g. 2004-fall).  The date range is inclusive (e.g.
2004-09-01 to 2004-12-31).  Please use ISO 8601 date format (YYYY-MM-DD).
</p>

<p i18n:translate="" tal:condition="view/context">
The date range is inclusive (e.g.  2004-09-01 to 2004-12-31).  Please use ISO
8601 date format (YYYY-MM-DD).
</p>

<div class="form">
  <div class="row" tal:condition="not:view/context"
                   tal:replace="structure view/name_widget">[Name]</div>
  <div class="row" tal:replace="structure view/start_widget">[Start]</div>
  <div class="row" tal:replace="structure view/end_widget">[End]</div>
  <div class="buttons" tal:condition="not:calendar">
    <input type="submit" class="button" name="NEXT"
           value="Next"
           i18n:attributes="value" />
  </div>
  <div class="buttons" tal:condition="calendar">
    <input type="submit" class="button" name="REFRESH"
           value="Refresh"
           i18n:attributes="value" />
  </div>
</div>

<tal:if condition="calendar">

<p i18n:translate="" tal:condition="not:view/context">
Second, please specify which days are school days, and which days are holidays.
</p>

<p i18n:translate="" tal:condition="view/context">
Please specify which days are school days, and which days are holidays.
</p>

<div class="form">
  <table id="legend" class="schooldaymodel">
    <tr class="legend">
      <td class="legend" i18n:translate="">Legend:</td>
      <td width="12%" class="schoolday" i18n:translate="">Schoolday</td>
      <td width="12%" class="holiday" i18n:translate="">Holiday</td>
      <td width="12%"></td>
      <td width="12%"></td>
      <td width="12%"></td>
      <td width="12%"></td>
      <td width="12%"></td>
    </tr>
  </table>

  <p>
    <span i18n:translate="">Toggle the following days of week: </span>
    <input class="button" type="submit" name="TOGGLE_0" value="Monday"
           i18n:attributes="value" />
    <input class="button" type="submit" name="TOGGLE_1" value="Tuesday"
           i18n:attributes="value" />
    <input class="button" type="submit" name="TOGGLE_2" value="Wednesday"
           i18n:attributes="value" />
    <input class="button" type="submit" name="TOGGLE_3" value="Thursday"
           i18n:attributes="value" />
    <input class="button" type="submit" name="TOGGLE_4" value="Friday"
           i18n:attributes="value" />
    <input class="button" type="submit" name="TOGGLE_5" value="Saturday"
           i18n:attributes="value" />
    <input class="button" type="submit" name="TOGGLE_6" value="Sunday"
           i18n:attributes="value" />
  </p>

  <p>Click on a day to toggle its state.</p>

  <table class="schooldaymodel" tal:repeat="month calendar">
    <tr>
      <th class="month" colspan="8" tal:content="month/title">[Month]</th>
    </tr>
    <tr>
      <th class="day"></th>
      <th class="day" width="12%" i18n:translate="">Monday</th>
      <th class="day" width="12%" i18n:translate="">Tuesday</th>
      <th class="day" width="12%" i18n:translate="">Wednesday</th>
      <th class="day" width="12%" i18n:translate="">Thursday</th>
      <th class="day" width="12%" i18n:translate="">Friday</th>
      <th class="day" width="12%" i18n:translate="">Saturday</th>
      <th class="day" width="12%" i18n:translate="">Sunday</th>
    </tr>
    <tr tal:repeat="week month/weeks">
      <th class="week" tal:content="week/title">[Week N]</th>
      <td tal:repeat="day week/days"
          tal:attributes="class day/class;
                          id python:day['index'] and 'td%d' % day['index'];
                          onclick day/onclick">
        <label tal:condition="day/number">
          <span tal:replace="day/number">N</span>
          <input type="checkbox" name="holiday" class="chk"
                 tal:attributes="value day/date; checked day/checked;
                           onchange string:javascript:update(${day/index});
                           id string:c${day/index};" />
        </label>
      </td>
    </tr>
  </table>

  <div class="buttons" tal:condition="not:view/context">
    <input type="submit" class="button" name="REFRESH"
           value="Refresh"
           i18n:attributes="value" />
    <input type="submit" class="button" name="CREATE"
           value="Create time period"
           i18n:attributes="value" />
  </div>

  <div class="buttons" tal:condition="view/context">
    <input type="submit" class="button" name="REFRESH"
           value="Refresh"
           i18n:attributes="value" />
    <input type="submit" class="button" name="UPDATE"
           value="Save changes"
           i18n:attributes="value" />
  </div>

</div>

</tal:if>

</form>

</metal:block>
</body>
</html>
