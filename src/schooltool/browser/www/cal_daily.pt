<html metal:use-macro="view/macros/calendarpage" i18n:domain="schooltool">
<head>
  <title metal:fill-slot="title" i18n:translate="">Calendar</title>
</head>
<body>
  <h1 metal:fill-slot="h1" i18n:translate="">
    Calendar for <span tal:replace="context/__parent__/title" i18n:name="title" />
  </h1>
  <metal:block metal:fill-slot="content">
    <h2 tal:content="view/cursor/isoformat" />
    <div class="calnav">
    <a tal:attributes="href string:${request/path}?date=${view/prev}" 
       i18n:translate="">
       Previous day</a>
    <a tal:attributes="href request/path" i18n:translate="">
       Today</a>
    <a tal:attributes="href string:${request/path}?date=${view/next}" 
       i18n:translate="">
        Next day</a>
    </div>

    <table class="daycal">
      <tr tal:repeat="row view/getHours">
        <td class="daycalhour">
          <a tal:content="row/title"
             tal:attributes="href string:${context/@@absolute_url}/add_event.html?start_date=${view/cursor}&start_time=${row/time}&duration=${row/duration}" />
        </td>
        <tal:block repeat="ev row/cols">
          <td tal:condition="python:ev is None" class="empty">&nbsp;</td>
          <td tal:condition="python:ev"
              tal:attributes="rowspan python:view.rowspan(ev);
                              class python:view.eventClass(ev)">
             <div class="daycalevent"
                  tal:content="structure python:view.renderEvent(ev, view.cursor)" />
          </td>
        </tal:block>
      </tr>
    </table>

  </metal:block>
</body>
</html>
