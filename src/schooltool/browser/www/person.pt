<html metal:use-macro="view/macros/page" i18n:domain="schooltool">
<head>
  <title metal:fill-slot="title" i18n:translate="">Person info</title>
</head>
<body>
  <h1 metal:fill-slot="h1" i18n:translate="">
    Person info for <span tal:replace="context/title" i18n:name="title"/>
  </h1>
  <metal:block metal:fill-slot="content" tal:define="info view/info">
    <div class="actions">
      <a class="action" tal:condition="view/canEdit"
         tal:attributes="href view/editURL"
         i18n:translate="">Edit</a>
      <a class="action" tal:condition="view/canChangePassword"
         tal:attributes="href view/passwordURL"
         i18n:translate="">Change password</a>
      <a class="action" tal:condition="view/canViewCalendar"
         tal:attributes="href string:${context/@@absolute_url}/calendar"
         i18n:translate="">View calendar</a>
    </div>

    <div tal:condition="view/canChooseCalendars" class="groups">
      <!-- XXX The double frame looks ugly -->
      <form method="POST" tal:attributes="action request/path">
        <h3 i18n:translate="">Groups</h3>

        <p>Merge calendars:</p>
        <p tal:repeat="group view/getParentGroups">
          <input type="checkbox"
                 tal:attributes="name string:group.${group/__name__};
                                 checked python:view.checked(group)" />
          <a tal:attributes="href group/@@absolute_url"
             tal:content="group/title"></a>
        </p>

        <input type="submit" name="SUBMIT" i18n:attributes="value"
               value="Update" />
      </form>
    </div>

    <div tal:condition="not:view/canChooseCalendars" class="groups">
      <h3 i18n:translate="">Groups</h3>
      <p tal:repeat="group view/getParentGroups">
       <a tal:attributes="href group/@@absolute_url"
          tal:content="group/title"></a>
      </p>
    </div>

    <div class="timetables"
         tal:define="timetables python:view.timetables(view.isManager())"
         tal:condition="timetables">
      <h3 i18n:translate="">Timetables</h3>
      <p tal:repeat="tt timetables">
       <a tal:omit-tag="tt/empty"
          tal:attributes="href tt/url" tal:content="tt/title"/>
       <tal:if tal:condition="view/isManager">
         (<a tal:attributes="href string:${tt/url}/setup.html"
             i18n:translate="">setup</a>)
       </tal:if>
      </p>
    </div>
    <div class="row"><b i18n:translate="">Username:</b>
      <span tal:replace="python:context.__name__">not_doe</span>
    </div>
    <div class="row"><b i18n:translate="">Title:</b>
      <span tal:replace="context/title">John, but not Doe</span>
    </div>
    <div class="row"><b i18n:translate="">First name:</b>
      <span tal:replace="info/first_name"></span>
    </div>
    <div class="row"><b i18n:translate="">Last name:</b>
      <span tal:replace="info/last_name"></span>
    </div>
    <div class="row"><b i18n:translate="">Date of birth:</b>
      <span tal:replace="info/date_of_birth"></span>
    </div>
    <div class="row"><b i18n:translate="">Comment:</b>
      <span tal:replace="info/comment"></span>
    </div>
    <div class="row">
      <b i18n:translate="">Photo:</b>
      <tal:block condition="not:view/photoURL" 
                 i18n:translate="">N/A</tal:block>
      <p tal:condition="view/photoURL">
        <img src="photo.jpg" tal:attributes="src view/photoURL" />
      </p>
    </div>
  </metal:block>
</body>
</html>
