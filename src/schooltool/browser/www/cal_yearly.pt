<html metal:use-macro="view/macros/calendarpage" i18n:domain="schooltool">
<head>
  <title metal:fill-slot="title" i18n:translate="">Calendar</title>
</head>
<body>
  <h1 metal:fill-slot="h1" i18n:translate="">
    Calendar for <span tal:replace="context/__parent__/title" />
  </h1>
  <metal:block metal:fill-slot="content">
    <div class="error" tal:content="view/update" />
    <h2 tal:content="python:view.cursor.strftime('%Y')" />
    <div class="calnav">
      <a tal:attributes="href python:view.calURL('yearly', view.prevYear())"
         i18n:translate="">Previous year</a>
      <a tal:attributes="href request/path"
         i18n:translate="">Current year</a>
      <a tal:attributes="href python:view.calURL('yearly', view.nextYear())"
         i18n:translate="">Next year</a>
    </div>

    <table class="cal_yearly"
           tal:define="quarters python:view.getYear(view.cursor)">
    <tr tal:repeat="quarter quarters">
      <td class="cal_yearly_month"
          tal:repeat="month quarter">
        <h2><a tal:content="python:month[1][0].date.strftime('%B')" /></h2>
        <table class="cal_yearly_month">
          <tr>
            <th class="cal_monthly_weekday"
                  tal:repeat="weekday python:month[0]"
                  tal:content="python:weekday.date.strftime('%a')" />
          </tr>
          <tr tal:repeat="week month">
            <td class="cal_yearly_day" tal:repeat="day week">
             <a tal:condition="python:day.date.month == month[1][0].date.month"
                tal:content="day/date/day"
                tal:attributes="href python:view.calURL('daily', day.date);
                                class python:(len(day.events) > 0
                                              and 'cal_yearly_day_busy'
                                              or  'cal_yearly_day')"/>
            </td> 
          </tr>
        </table>
      </td>
    </tr>
    </table>
  </metal:block>
</body>
</html>
