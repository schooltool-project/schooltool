<div>

<form method="POST" enctype="multipart/form-data" class="standalone"
      tal:attributes="action request/URL">

  <p i18n:translate="">
    CSV data <strong>must</strong> contain a user name a first name and a last name.
    An optional password <strong >may</strong> be included as well.
  </p>
  <p i18n:translate="">Example:</p>

<pre class="csv-text" i18n:translate="">
jjones, Jimmy, Jones
jbjones, Jim Bob, Jones, r2m45J
howard, Howard, Jobs
</pre>

  <p i18n:translate="">
    The above example will create three users, 'jjones', 'jbjones' and
    'howard'.  Of the three, only 'jbjones' has a password ('r2m45J') and
    will be able to login to the system.  Note that passwords must be
    sent in plain text.
  </p>

  <fieldset name="select-mode">

    <legend><span i18n:translate="">Import source</span></legend>

    <div class="row">
      <div class="widget">
        <span class="option">
          <label>
            <input type="radio"
                   name="csv-input-mode"
                   tal:attributes="checked python:view.mode!='text' and 'checked'"
                   value="upload" />
            <span class="label" i18n:translate="">Upload CSV file</span>
          </label>
        </span>
        <span class="option">
          <label>
            <input type="radio"
                   tal:attributes="checked python:view.mode=='text' and 'checked'"
                   name="csv-input-mode"
                   value="text" />
            <span i18n:translate="">Enter CSV text</span>
          </label>
        </span>
      </div>
    </div>
  </fieldset>

  <script type="text/javascript">
    $(document).ready(function() {
      function update_fieldset(f){
        var mode = $(f).val();
        $('fieldset[name|=csv-mode]').hide().filter('fieldset[name=csv-mode-' + mode + ']').show();
      };
      var mode_field = $('input[name=csv-input-mode]');
      mode_field.change(function(){update_fieldset(this);});
      var active_field = $('input[name=csv-input-mode][checked=checked]');
      update_fieldset(active_field);
    });
  </script>

  <div class="status"
       tal:repeat="error view/errors">
    <div class="summary ui-state-error ui-corner-all">
      <span class="ui-icon ui-icon-alert">icon</span>
      <tal:block content="error">
        [error message]
      </tal:block>
    </div>
  </div>

  <fieldset name="csv-mode-upload">
    <legend><span i18n:translate="">Import CSV</span></legend>
    <div class="row">
      <div class="label">
        <label for="csvfile">
          <span i18n:translate="">Upload CSV file</span>
        </label>
      </div>
      <div class="widget">
        <input id="csvfile" type="file" name="csvfile"/>
      </div>
    </div>
    
    <div class="row">
      <div class="label">
        <label for="charset">
          <span i18n:translate="">Charset</span>
        </label>
      </div>
      <div class="widget">
        <select name="charset">
          <option value="UTF-8" i18n:translate="">Unicode (UTF-8)</option>
          <option value="ISO-8859-1" i18n:translate="">Western (ISO-8859-1)</option>
          <option value="ISO-8859-15" i18n:translate="">Western (ISO-8859-15)</option>
          <option value="Windows-1252" i18n:translate="">Western (Windows-1252)</option>
          <option value="other" i18n:translate="">Other (please specify)</option>
        </select>
      </div>
    </div>
    <div class="row" i18n:translate="">
      <div class="label">
        <label for="other_charset">
          <span i18n:translate="">Other charset</span>
        </label>
      </div>
      <div class="row">
        <input name="other_charset" type="text" i18n:name="other_charset" />
      </div>
    </div>
  </fieldset>
  
  <fieldset name="csv-mode-text">
    <legend><span i18n:translate="">Import CSV</span></legend>
    <div class="row">
      <div class="label">
        <label for="csvtext">
          <span i18n:translate="">Enter CSV text</span>
        </label>
      </div>
      <textarea name="csvtext" id="csvtext" cols="50" rows="10"
                tal:content="view/csvtext|nothing"></textarea>
    </div>
  </fieldset>
  <div class="buttons">
    <input name="UPDATE_SUBMIT" class="button-ok" type="submit"
           value="Submit" i18n:attributes="value submit-button" />
  </div>
</form>

<h3><a tal:attributes="href view/nextURL">Done</a></h3>

</div>
