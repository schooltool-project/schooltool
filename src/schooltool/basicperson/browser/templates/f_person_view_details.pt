    <link type="text/css" rel="stylesheet"
          tal:attributes="href context/++resource++jstree/style.css" />
    <script type="text/javascript"
            tal:attributes="src context/++resource++jstree/jquery.tree.js"></script>
    <script type="text/javascript"
            tal:attributes="src context/++resource++jstree/script.js"></script>
    <metal:block
        tal:replace='structure string:&lt;script type="text/javascript"&gt;' />
      $(document).ready(function() {
        var person_preferences_form_id = '#person_preferences_form';
        $(person_preferences_form_id).load('<metal:block tal:replace="string:${context/@@absolute_url}/preferences" />').hide();
        $(person_preferences_form_id).dialog({
          autoOpen: false,
          modal: true,
          resizable: false,
          draggable: false
        });
        // XXX: we need to assign better this JS to the action button
        $('#edit_preferences').click(function(e) {
          $(person_preferences_form_id).dialog({
            width: $(person_preferences_form_id).find('form').width() + 30
          });
          $(person_preferences_form_id).dialog('open');
          e.preventDefault();
        });
      });
    <metal:block tal:replace="structure string:&lt;/script&gt;" />

<div class="person-info">
  <tal:block tal:replace="structure context/schooltool:content/schooltool.person.FlourishInfo"/>
  <a id="edit_preferences" href="#">Preferences</a>
  <div id="person_preferences_form" />
</div>
