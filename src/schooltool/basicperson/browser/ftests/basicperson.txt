Basic Person
============

A manager logs in

    >>> manager = Browser('manager', 'schooltool')

    >>> from schooltool.app.browser.ftests import setup
    >>> setup.setUpBasicSchool()

Create a Basic Person, a teacher.

    >>> manager.getLink('Manage').click()
    >>> manager.getLink('Persons').click()
    >>> manager.getLink('New Person').click()
    >>> manager.getControl('First name').value = "John"
    >>> manager.getControl('Last name').value = "Petterson"
    >>> manager.getControl('Gender').value = ['male']
    >>> manager.getControl('Birth date').value = '80/01/01'

    >>> manager.getControl('Username').value = "john"
    >>> manager.getControl('Password').value = "pwd"
    >>> manager.getControl('Confirm').value = "pwd"
    >>> manager.getControl('Add').click()

    >>> manager.getLink('edit groups').click()
    >>> manager.getControl('Teachers').click()
    >>> manager.getControl('Add').click()

Go to the person list:

    >>> manager.getLink('Manage').click()
    >>> manager.getLink('Persons').click()

Both of our users are in there:

    >>> manager.getLink('John')
    <Link text='John' url='http://localhost/persons/john'>

    >>> manager.getLink('Administrator', index=1)
    <Link text='Administrator' url='http://localhost/persons/manager'>

You can filter the list:

    >>> manager.getControl(name='SEARCH_TITLE').value = "John"
    >>> manager.getControl('Find Now').click()

And now we only have John in there:

    >>> manager.getLink('John')
    <Link text='John' url='http://localhost/persons/john'>

    >>> manager.getLink('Administrator', index=1)
    Traceback (most recent call last):
    ...
    LinkNotFoundError

We can click on John and edit his record (we'll change it back as well):

    >>> manager.getLink('John').click()
    >>> manager.getLink('Edit').click()
    >>> manager.getControl('First name').value = 'Johnny'
    >>> manager.getControl('Apply').click()
    >>> manager.getControl('First name').value = 'John'
    >>> manager.getControl('Apply').click()

Now there even are person export views:

    >>> manager.open('http://localhost/persons/@@person_export.xml')
    >>> print manager.contents
    <person_export xmlns:basic="http://schooltool.org/ns/model/0.1/basicperson"
                   xmlns="http://schooltool.org/ns/model/0.1">
      <groups>
        <group>
          <id>teachers</id>
          <title>Teachers</title>
          <description>Teachers.</description>
        </group>
      </groups>
      <persons>
        <person>
          <username>john</username>
          <title>Petterson, John</title>
          <basic:first_name>John</basic:first_name>
          <basic:last_name>Petterson</basic:last_name>
          <basic:gender>male</basic:gender>
          <basic:birth_date>1980-01-01</basic:birth_date>
          <groups>
            <group id="teachers" />
          </groups>
        </person>
        <person>
          <username>manager</username>
          <title>Administrator, SchoolTool</title>
          <basic:first_name>SchoolTool</basic:first_name>
          <basic:last_name>Administrator</basic:last_name>
        </person>
      </persons>
    </person_export>

    >>> manager.open('http://localhost/persons/john/@@person_export.xml')
    >>> print manager.contents
    <person_export xmlns:basic="http://schooltool.org/ns/model/0.1/basicperson"
                   xmlns="http://schooltool.org/ns/model/0.1">
      <groups>
        <group>
          <id>teachers</id>
          <title>Teachers</title>
          <description>Teachers.</description>
        </group>
      </groups>
      <persons>
        <person>
          <username>john</username>
          <title>Petterson, John</title>
          <basic:first_name>John</basic:first_name>
          <basic:last_name>Petterson</basic:last_name>
          <basic:gender>male</basic:gender>
          <basic:birth_date>1980-01-01</basic:birth_date>
          <groups>
            <group id="teachers" />
          </groups>
        </person>
      </persons>
    </person_export>

Now let's create another teacher, Bob.

    >>> manager.open('http://localhost/')
    >>> manager.getLink('Manage').click()
    >>> manager.getLink('Persons').click()
    >>> manager.getLink('New Person').click()
    >>> manager.getControl('First name').value = "Bob"
    >>> manager.getControl('Last name').value = "Roberts"
    >>> manager.getControl('Gender').value = ['male']
    >>> manager.getControl('Birth date').value = '80/01/01'

    >>> manager.getControl('Username').value = "bob"
    >>> manager.getControl('Password').value = "pwd"
    >>> manager.getControl('Confirm').value = "pwd"
    >>> manager.getControl('Add').click()
    >>> manager.getLink('edit groups').click()
    >>> manager.getControl('Teachers').click()
    >>> manager.getControl('Add').click()

Now, when we create a student, we will have two persons available to
choose as an advisor.  We will choose John.

    >>> manager.getLink('Manage').click()
    >>> manager.getLink('Persons').click()
    >>> manager.getLink('New Person').click()
    >>> manager.getControl('First name').value = "Student"
    >>> manager.getControl('Last name').value = "One"
    >>> manager.getControl('Gender').value = ['male']
    >>> manager.getControl('Birth date').value = '80/01/01'

    >>> manager.getControl('Username').value = "student"
    >>> manager.getControl('Password').value = "pwd"
    >>> manager.getControl('Confirm').value = "pwd"
    >>> manager.getControl('Add').click()

By the way - CVS import views should still be working even when we are
using this kind of person:

    >>> manager.getLink('Manage').click()
    >>> manager.getLink('Persons').click()
    >>> manager.getLink('Import Persons').click()
    >>> csvtext = "steve, Steve, Smith, secret\npete, Pete, Marley"
    >>> manager.getControl(name='csvtext').value = csvtext
    >>> manager.getControl(name='charset').value = ['UTF-8']
    >>> manager.getControl(name='UPDATE_SUBMIT').click()

Now we have some additional persons in the database, let's look at one
of them:

    >>> manager.open('http://localhost/persons/steve/@@person_export.xml')
    >>> print manager.contents
    <person_export xmlns:basic="http://schooltool.org/ns/model/0.1/basicperson"
                   xmlns="http://schooltool.org/ns/model/0.1">
      <persons>
        <person>
          <username>steve</username>
          <title>Smith, Steve</title>
          <basic:first_name>Steve</basic:first_name>
          <basic:last_name>Smith</basic:last_name>
        </person>
      </persons>
    </person_export>
