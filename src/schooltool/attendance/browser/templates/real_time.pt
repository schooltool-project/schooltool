<html metal:use-macro="view/@@standard_macros/page" i18n:domain="schoolbell">
<head>
  <title metal:fill-slot="title" i18n:translate=""
    ><span i18n:name="section" i18n:translate=""
           tal:replace="context/label"/> attendance</title>
</head>
<body>

<metal:block metal:fill-slot="content-header">
<h2 i18n:translate="">Section attendance for <span i18n:name="section"
  tal:replace="context/label" i18n:translate="" /> at <span i18n:name="date"
  tal:replace="view/date" /> period <span i18n:name="period_id"
  tal:replace="view/period_id" /></h2>
</metal:block>

<metal:block metal:fill-slot="body">
<form tal:attributes="action
                      string:${request/URL}/${view/date}/${view/period_id}"
      method="POST">

<div class="error" tal:condition="view/error" tal:content="view/error"
     i18n:translate="">
</div>

<div class="attendance-legend">
  <p i18n:translate="">
  The sparkline (the little graph next to each student's name) shows
  the student's attendance for the last ten schooldays.  If attendance
  status for a day is unknown the sparkline shows a dot. If the section
  meets on a given day, the sparkline shows a long whisker, if it doesn't,
  a half-length whisker.  The whisker is points upwards if the
  student was present during the homeroom period. An unexplained
  absence for a meeting is coloured red, and an unexplained absence for
  homeroom period is yellow.
  </p>
  <p i18n:translate="">Color codes:
  <span class="attendance-clear">no records</span>,
  <span class="attendance-present">present</span>,
  <span class="attendance-explained">was absent with explanation earlier today</span>,
  <span class="attendance-absent">was absent without explanation</span>,
  <span class="attendance-alert">was present and absent earlier today</span>.
  </p>
</div>

<table class="attendance-table">
  <tr>
    <th>&nbsp;</th>
    <th i18n:translate="">Name</th>
    <th i18n:translate="">Status</th>
  </tr>

  <tal:loop repeat="info view/listMembers">
  <tr class="attendance-row"
      tal:define="check_id python:'%s_check' % info.name">
    <td>
      <input type="checkbox"
             tal:attributes="
                  name check_id;
                  id check_id;
                  disabled info/disabled;
                  checked python:view.error and check_id in request"/>
    </td>
    <td tal:attributes="class info/color">
       <label tal:attributes="for check_id"
              tal:content="info/title">Name</label>
    </td>
    <td>
      <img width="30" height="12" tal:attributes="src info/sparkline_url" />
      <span tal:replace="info/symbol" />
    </td>
  </tr>
  </tal:loop>
</table>

<div class="controls">
  <input type="submit" name="ABSENT" value="Mark as absent"
         i18n:attributes="value" tal:condition="view/unknowns" />
  <tal:block condition="not:view/unknowns">
  <input type="submit" name="TARDY" value="Make tardy"
         i18n:attributes="value" />
  <label for="arrival" i18n:translate="">Arrived at</label>
  <input type="text" id="arrival" name="arrival"
       tal:attributes="value python:view.error and request['arrival'] or ''"/>
  </tal:block>
</div>
</form>

</metal:block>
</body>
</html>
