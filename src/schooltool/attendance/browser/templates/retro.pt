<html metal:use-macro="view/@@standard_macros/page" i18n:domain="schooltool">
<head>
  <title metal:fill-slot="title" i18n:translate=""
    ><span i18n:name="section"
           tal:replace="context/label"/> attendance</title>
</head>
<body>

<metal:block metal:fill-slot="content-header">
<h2 tal:condition="view/homeroom" i18n:translate="">Homeroom attendance for
  <span i18n:name="section" tal:replace="context/label" />
  at <span i18n:name="date" tal:replace="view/date" />
  period <span i18n:name="period_id" tal:replace="view/period_id" /></h2>
<h2 tal:condition="not:view/homeroom" i18n:translate="">Section attendance for
  <span i18n:name="section" tal:replace="context/label" />
  at <span i18n:name="date" tal:replace="view/date" />
  period <span i18n:name="period_id" tal:replace="view/period_id" /></h2>
</metal:block>

<metal:block metal:fill-slot="body">
<form tal:attributes="action request/URL" method="POST">

<input type="hidden" name="date" tal:attributes="value view/date" />
<input type="hidden" name="period_id" tal:attributes="value view/period_id" />

<div class="error" tal:condition="view/error" tal:content="view/error">
</div>

<p i18n:translate="">For Tardy, enter a number of minutes late. This
  field is optional.</p>

<table class="attendance-table">
  <tr class="attendance-retro-row">
    <th i18n:translate="" class="first">Name</th>
    <th i18n:translate="" class="other">Present</th>
    <th i18n:translate="" class="other">Absent</th>
    <th i18n:translate="" class="other">Tardy, mins late/arrival time</th>
  </tr>

  <tal:loop repeat="info view/listMembers">
  <tr class="attendance-retro-row"
      tal:define="map python:{'-': 'A', '+': 'P', 'T': 'T', ' ': 'P'};
           default python:map[info.symbol];
           value python:request.form.get(info.name, default);
           disabled python:info.symbol != ' '">
    <td tal:attributes="class info/color" class="first">
       <label tal:content="info/title"
              tal:attributes="class python:disabled and 'disabled' or None">
          Name
       </label>
    </td>
    <td class="other">
      <input type="radio" value="P"
             tal:attributes="name info/name;
                             disabled disabled;
                             checked python:value == 'P' or None"/>
    </td>
    <td class="other">
      <input type="radio" value="A"
             tal:attributes="name info/name;
                             disabled disabled;
                             checked python:value == 'A' or None"/>
    </td>
    <td tal:define="error python:view.arrival_errors.get(info.name)"
        tal:attributes="class python: error and 'other error' or 'other'">
      <input type="radio" value="T"
             tal:attributes="name info/name;
                             disabled disabled;
                             checked python:value == 'T' or None"/>
      <input type="text"
             tal:define="name string:${info/name}_tardy;
                         default python:info.arrival_time
                                 and info.arrival_time.strftime('%H:%M')"
             tal:attributes="name name;
                             disabled disabled;
                             value python:request.get(name, default)"/>
      <p tal:condition="error" tal:content="error" class="error" />
    </td>
  </tr>
  </tal:loop>
</table>

<div class="controls">
  <input type="submit" name="SUBMIT" value="Submit" class="button-ok"
         i18n:attributes="value"/>
</div>
</form>

</metal:block>
</body>
</html>
