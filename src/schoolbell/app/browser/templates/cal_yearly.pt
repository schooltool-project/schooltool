<!-- <html metal:use-macro="view/macros/calendarpage" i18n:domain="schooltool"> -->
<tal:defs define="status view/update" />
<html metal:use-macro="view/@@standard_macros/page" i18n:domain="schooltool">

  <head>
    <title metal:fill-slot="title" i18n:translate="">Calendar</title>
  </head>

  <h1 metal:fill-slot="h1" i18n:translate="">
    Calendar for <span tal:replace="context/__parent__/title"
      i18n:name="title" />
  </h1>

  <!--
  <metal:block fill-slot="column-left-extra">
    <metal:macro use-macro="view/macros/portlet-calendar-overlay" />

    <metal:macro use-macro="view/macros/portlet-tomorrow-events" />

    <metal:block use-macro="view/macros/portlet-calendar-jumpto" />
  </metal:block>
  -->

  <metal:block metal:fill-slot="body">

    <h2 class="calendar-view-title"
        tal:content="python:view.cursor.strftime('%Y')" />

      <div id="calendar-navigation-context">
        <table cellpadding="0" cellspacing="0" width="100%">
          <tr>
            <td align="left" width="33%">
              <a id="calendar-navigation-context-previous"
                tal:attributes="href python:view.calURL('yearly', view.prevYear())"
                i18n:translate="">Previous year</a>
            </td>
            <td align="center">
              <a id="calendar-navigation-context-current"
                tal:attributes="href request/URL"
                i18n:translate="">Current year</a>
            </td>
            <td align="right" width="33%">
              <a id="calendar-navigation-context-next"
                tal:attributes="href python:view.calURL('yearly', view.nextYear())"
                i18n:translate="">Next year</a>
            </td>
          </tr>
        </table>
      </div>

    <table id="calendar-view-year"
        cellpadding="0" cellspacing="0"
        tal:define="quarters python:view.getYear(view.cursor)">

      <tr tal:repeat="quarter quarters">
        <td class="month" valign="top"
            tal:repeat="month quarter">
          <table class="month" cellpadding="0" cellspacing="0">
            <tr>
              <th colspan="7" class="month-title"
                  tal:define="mtit python:view.monthTitle(month[1][0].date)">
                <a tal:content="mtit"
                    tal:attributes="href python:view.calURL('monthly',
                                    month[1][0].date);
                                    title mtit"/>
              </th>
            </tr>
            <tr>
              <th class="month-weekday"
                  tal:repeat="weekday python:month[0]"
                  tal:content="python:view.shortDayOfWeek(weekday.date)" />
            </tr>
            <tr tal:repeat="week month">
              <td tal:replace="structure
                  python:view.renderRow(week, month[1][0].date.month)" />
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </metal:block>
</html>
