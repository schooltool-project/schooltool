<tal:defs define="status view/update" />
<html metal:use-macro="view/@@standard_macros/calendar-page" i18n:domain="schooltool">
<metal:block metal:fill-slot="calendar-body">
  <table id="calendar-view-week" cellpadding="0" cellspacing="0" width="100%"
         tal:define="days view/getCurrentWeek">
    <tr>
      <tal:loop repeat="day days">
        <th class="day-title"
            tal:define="start repeat/day/start"
            tal:attributes="class python:start and 'day-title first'
                                                or 'day-title'">
          <a tal:content="python:view.dayTitle(day.date)"
             tal:attributes="href python:view.calURL('daily', day.date)" />
        </th>
      </tal:loop>
    </tr>
    <tr>
      <tal:loop repeat="day days">
        <td valign="top" height="100"
            tal:define="start repeat/day/start"
            tal:attributes="class python:start and 'first' or ''">
          <div tal:repeat="event day/events">
            <a tal:define="start repeat/event/start;
                           evdate python:event.dtstart.strftime('%Y-%m-%d')"
               tal:attributes="class python:start and 'first' or '';
                               href string:${context/@@absolute_url}/edit_event.html?date=${evdate}&amp;event_id=${event/unique_id};
                               style python:'background: %s;; margin: 2px;;' % event.color1;
                               title event/title"> <!-- XXX style attr is ICK!! -->
              <span tal:content="python:view.ellipsizeTitle(event.title)"/>
              (<span tal:content="python:event.dtstart.strftime('%H:%M')"/> - <span tal:content="python:event.dtend.strftime('%H:%M')"/>)
            </a>
          </div>
        </td>
      </tal:loop>
    </tr>
  </table>

</metal:block>
</html>
